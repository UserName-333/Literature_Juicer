<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡çŒ®æ¦¨æ±æœº - æ™ºèƒ½è®ºæ–‡åˆ†æç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¤–</text></svg>">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                            950: '#082f49',
                        },
                        neon: {
                            blue: '#00d4ff',
                            purple: '#a855f7',
                            green: '#22d3ee',
                            pink: '#ec4899'
                        }
                    },
                    backgroundImage: {
                        'cyber-gradient': 'linear-gradient(135deg, #0c1428 0%, #1e293b 50%, #0f172a 100%)',
                        'neon-gradient': 'linear-gradient(45deg, #00d4ff, #a855f7)',
                        'analysis-gradient': 'linear-gradient(135deg, #1e293b 0%, #334155 100%)'
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'float': 'float 6s ease-in-out infinite',
                        'scan': 'scan 2s linear infinite',
                        'typewriter': 'typewriter 4s steps(40) 1s forwards'
                    },
                    keyframes: {
                        glow: {
                            '0%': { 
                                'box-shadow': '0 0 20px rgba(0, 212, 255, 0.5)',
                                'border-color': 'rgba(0, 212, 255, 0.5)'
                            },
                            '100%': { 
                                'box-shadow': '0 0 40px rgba(0, 212, 255, 0.8)',
                                'border-color': 'rgba(0, 212, 255, 0.8)'
                            }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        scan: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100vw)' }
                        },
                        typewriter: {
                            '0%': { width: '0' },
                            '100%': { width: '100%' }
                        }
                    },
                    fontFamily: {
                        'cyber': ['Orbitron', 'monospace'],
                        'mono': ['Fira Code', 'monospace']
                    }
                },
            },
        }
    </script>
    
    <style>
        * {
            scroll-behavior: smooth;
        }
        
        body {
            background: linear-gradient(135deg, #0c1428 0%, #1e293b 50%, #0f172a 100%);
            overflow-x: hidden;
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        /* éœ“è™¹ç¯æ•ˆæœ */
        .neon-border {
            border: 1px solid rgba(0, 212, 255, 0.5);
            box-shadow: 
                0 0 10px rgba(0, 212, 255, 0.3),
                inset 0 0 10px rgba(0, 212, 255, 0.1);
        }
        
        .neon-border:hover {
            border-color: #00d4ff;
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.6),
                inset 0 0 20px rgba(0, 212, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        /* å‘å…‰æŒ‰é’® */
        .glow-button {
            background: linear-gradient(to right, #00d4ff, #a855f7);
            color: white;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.3s ease;
            transform: scale(1);
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.4),
                0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .glow-button:hover {
            transform: scale(1.05);
            box-shadow: 
                0 0 30px rgba(0, 212, 255, 0.6),
                0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        /* ç§‘å¹»å¡ç‰‡ */
        .cyber-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.4) 0%, 
                rgba(51, 65, 85, 0.3) 50%, 
                rgba(30, 41, 59, 0.4) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.5);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .cyber-card:hover {
            border-color: rgba(0, 212, 255, 0.5);
            transform: translateY(-4px);
            box-shadow: 
                0 0 25px rgba(0, 212, 255, 0.2),
                0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* è¾“å…¥æ¡†æ ·å¼ */
        .cyber-input {
            background: rgba(15, 23, 42, 0.5);
            border: 1px solid rgb(71, 85, 105);
            border-radius: 8px;
            padding: 12px 16px;
            color: white;
            transition: all 0.3s ease;
        }
        
        .cyber-input::placeholder {
            color: rgb(148, 163, 184);
        }
        
        .cyber-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }
        
        /* è¿›åº¦æ¡ */
        .progress-bar {
            height: 8px;
            background: rgb(51, 65, 85);
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #00d4ff, #a855f7);
            border-radius: 9999px;
            transition: all 0.5s ease;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        /* æ¶ˆæ¯æ°”æ³¡å¸ƒå±€ - ç§»é™¤äº†è€çš„èƒŒæ™¯æ ·å¼ */
        
        /* è¯­è¨€æŒ‰é’® */
        .language-btn {
            padding: 8px 16px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgb(71, 85, 105);
            border-radius: 8px;
            color: rgb(203, 213, 225);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .language-btn:hover {
            background: rgba(51, 65, 85, 0.5);
            border-color: rgb(100, 116, 139);
            color: white;
        }
        
        .language-btn.active {
            background: linear-gradient(45deg, #00d4ff, #a855f7);
            border-color: #00d4ff;
            color: white;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }
        
        /* ç§‘å¹»æŒ‰é’® */
        .cyber-button {
            padding: 8px 16px;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 6px;
            color: #00d4ff;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .cyber-button:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: #00d4ff;
            color: white;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
            transform: translateY(-1px);
        }
        
        /* æ–‡æ¡£èŠ‚ç‚¹åŠ¨ç”» */
        .doc-section.processing {
            background: rgba(0, 212, 255, 0.1);
            border-left-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }
        
        .doc-section.completed {
            background: rgba(34, 197, 94, 0.1);
            border-left-color: #22c55e;
        }
        
        /* åˆ†å—æ ·å¼ */
        .chunk-item {
            padding: 8px 12px;
            background: rgba(51, 65, 85, 0.3);
            border: 1px solid rgba(71, 85, 105, 0.5);
            border-radius: 6px;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .chunk-item:hover {
            background: rgba(71, 85, 105, 0.4);
            border-color: rgba(0, 212, 255, 0.3);
        }
        
        .chunk-item.active {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }
        
        /* ç¥ç»ç½‘ç»œç”»å¸ƒæ ·å¼ */
        #neural-network-canvas {
            cursor: grab;
        }
        
        #neural-network-canvas:active {
            cursor: grabbing;
        }
        
        /* æ•°å­—åŠ¨ç”» */
        .count-up {
            animation: countUp 2s ease-out forwards;
        }
        
        @keyframes countUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* é€šçŸ¥é˜Ÿåˆ—æ ·å¼ */
        #notification-container {
            pointer-events: none;
        }

        .notification-item {
            pointer-events: auto;
            max-width: 320px;
            backdrop-filter: blur(10px);
            animation: slideInFromRight 0.3s ease-out;
        }

        .notification-item:hover {
            transform: translateX(-5px) !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .notification-item button {
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .notification-item:hover button {
            opacity: 1;
        }

        @keyframes slideInFromRight {
            from {
                transform: translateX(100%) scale(0.9);
                opacity: 0;
            }
            to {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
        }

                        @keyframes slideOutToRight {
                    from {
                        transform: translateX(0) scale(1);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(100%) scale(0.8);
                        opacity: 0;
                    }
                }

                /* æ‰“å­—æœºæ•ˆæœ */
                .typewriter {
                    overflow: hidden;
                    white-space: pre-wrap;
                    word-wrap: break-word;
                }

                .typewriter-cursor {
                    display: inline-block;
                    width: 2px;
                    height: 1.2em;
                    background-color: #00d4ff;
                    margin-left: 2px;
                    animation: blink 1s infinite;
                }

                @keyframes blink {
                    0%, 50% { opacity: 1; }
                    51%, 100% { opacity: 0; }
                }

                .typing-indicator {
                    display: inline-flex;
                    align-items: center;
                    padding: 8px 12px;
                    background: rgba(100, 116, 139, 0.3);
                    border-radius: 12px;
                    margin: 8px 0;
                }

                .typing-indicator .dot {
                    width: 6px;
                    height: 6px;
                    border-radius: 50%;
                    background-color: #64748b;
                    margin: 0 2px;
                    animation: typingDots 1.4s infinite;
                }

                .typing-indicator .dot:nth-child(2) {
                    animation-delay: 0.2s;
                }

                .typing-indicator .dot:nth-child(3) {
                    animation-delay: 0.4s;
                }

                @keyframes typingDots {
                    0%, 60%, 100% {
                        transform: translateY(0);
                        opacity: 0.4;
                    }
                    30% {
                        transform: translateY(-10px);
                        opacity: 1;
                    }
                }

                @keyframes slideInUp {
                    from {
                        transform: translateY(20px);
                        opacity: 0;
                    }
                    to {
                        transform: translateY(0);
                        opacity: 1;
                    }
                }

                /* æ¶ˆæ¯æ°”æ³¡æ ·å¼ */
                .message-bubble {
                    animation: messageAppear 0.4s ease-out;
                }

                .message-user {
                    transform-origin: bottom right;
                }

                .message-ai {
                    transform-origin: bottom left;
                }

                @keyframes messageAppear {
                    from {
                        opacity: 0;
                        transform: translateY(15px) scale(0.95);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0) scale(1);
                    }
                }

                /* æ”¹è¿›æ‰“å­—æœºæ ·å¼ */
                .typewriter {
                    min-height: 1.25rem;
                }

                .typewriter-text {
                    display: inline;
                }

                .typewriter-cursor {
                    display: inline-block;
                    width: 1px;
                    height: 1em;
                    background-color: #00d4ff;
                    margin-left: 1px;
                    animation: blink 0.8s infinite;
                    vertical-align: baseline;
                    opacity: 0.8;
                }
        
        /* Markdown æ ·å¼ */
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #00d4ff;
            font-weight: 600;
            margin-bottom: 16px;
            margin-top: 24px;
        }
        
        .markdown-content h1 { font-size: 1.5rem; }
        .markdown-content h2 { font-size: 1.25rem; }
        .markdown-content h3 { font-size: 1.125rem; }
        
        .markdown-content p {
            margin-bottom: 16px;
            line-height: 1.7;
        }
        
        .markdown-content ul, .markdown-content ol {
            margin-bottom: 16px;
            margin-left: 24px;
        }
        
        .markdown-content li {
            margin-bottom: 8px;
        }
        
        .markdown-content code {
            background: rgb(30, 41, 59);
            color: #22d3ee;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
        }
        
        .markdown-content pre {
            background: rgb(15, 23, 42);
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 16px;
        }
        
        .markdown-content blockquote {
            border-left: 4px solid #00d4ff;
            padding-left: 16px;
            font-style: italic;
            color: rgb(203, 213, 225);
            margin-bottom: 16px;
        }
        
        /* æ‰«æçº¿åŠ¨ç”» */
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100vw); }
        }
        
        .scan-line {
            animation: scan 3s linear infinite;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="fixed inset-0 pointer-events-none">
        <div class="absolute top-20 left-10 w-64 h-64 bg-blue-500/5 rounded-full blur-3xl"></div>
        <div class="absolute bottom-20 right-10 w-96 h-96 bg-purple-500/5 rounded-full blur-3xl"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[800px] h-[400px] bg-cyan-500/3 rounded-full blur-3xl"></div>
    </div>

    <!-- æ‰«æçº¿æ•ˆæœ -->
    <div class="fixed top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-30 scan-line"></div>

    <div id="app" class="relative z-10">
        <!-- å¯¼èˆªæ  -->
        <nav class="border-b border-slate-700/50 backdrop-blur-sm bg-slate-900/20">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-400 to-purple-500 rounded-lg flex items-center justify-center animate-pulse">
                            <span class="text-xl">ğŸ¤–</span>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-white" style="font-family: 'Orbitron', monospace;">æ–‡çŒ®æ¦¨æ±æœº</h1>
                            <p class="text-sm text-slate-400">æ™ºèƒ½è®ºæ–‡åˆ†æç³»ç»Ÿ</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="window.location.href='æ–‡çŒ®æ¦¨æ±æœº.html'" class="px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-lg text-purple-300 hover:bg-purple-500/30 hover:text-white transition-all">
                            <i class="fas fa-arrow-left mr-2"></i>è¿”å›ä»‹ç»
                        </button>
                        <button id="restart-analysis" onclick="app.restartAnalysis()" class="px-4 py-2 bg-cyan-500/20 border border-cyan-500/30 rounded-lg text-cyan-300 hover:bg-cyan-500/30 hover:text-white transition-all hidden">
                            <i class="fas fa-refresh mr-2"></i>é‡æ–°åˆ†æ
                        </button>
                        <button id="new-document" onclick="app.uploadNewDocument()" class="px-4 py-2 bg-orange-500/20 border border-orange-500/30 rounded-lg text-orange-300 hover:bg-orange-500/30 hover:text-white transition-all hidden">
                            <i class="fas fa-plus mr-2"></i>æ–°æ–‡æ¡£
                        </button>
                        <div class="px-3 py-1 bg-green-500/20 border border-green-500/30 rounded-full">
                            <span class="text-green-400 text-sm" style="font-family: 'Fira Code', monospace;">â— ç³»ç»Ÿåœ¨çº¿</span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="max-w-7xl mx-auto px-6 py-8">
            <!-- ä¸Šä¼ åŒºåŸŸ -->
            <div id="upload-section" class="mb-8">
                <div class="cyber-card p-8 text-center">
                    <div class="mb-6">
                        <div class="w-24 h-24 mx-auto bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center mb-4 animate-bounce">
                            <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                        </div>
                        <h2 class="text-3xl font-bold text-white mb-2" style="font-family: 'Orbitron', monospace;">ä¸Šä¼ æ‚¨çš„å­¦æœ¯è®ºæ–‡</h2>
                        <p class="text-slate-400 text-lg">æ”¯æŒ PDFã€DOCã€DOCXã€TXT æ ¼å¼ï¼Œè·å¾—ä¸“ä¸šçš„AIåˆ†æ</p>
                    </div>

                    <!-- æ–‡ä»¶ä¸Šä¼ åŒº -->
                    <div class="mb-6">
                        <div id="drop-zone" class="border-2 border-dashed border-slate-600 rounded-xl p-8 transition-all duration-300 hover:border-blue-400/50 hover:bg-slate-800/20 cursor-pointer">
                            <input type="file" id="file-input" class="hidden" accept=".pdf,.doc,.docx,.txt">
                            <div class="text-center">
                                <svg class="w-16 h-16 mx-auto text-slate-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                                <p class="text-slate-300 text-lg mb-2">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©</p>
                                <p class="text-slate-500 text-sm">æœ€å¤§æ”¯æŒ 50MB</p>
                            </div>
                        </div>
                    </div>

                    <!-- è¯­è¨€é€‰æ‹© -->
                    <div class="mb-6">
                        <h3 class="text-white font-semibold mb-4">é€‰æ‹©åˆ†æè¯­è¨€</h3>
                        <div class="flex flex-wrap justify-center gap-3">
                            <button class="language-btn active" data-lang="ä¸­æ–‡">ä¸­æ–‡</button>
                            <button class="language-btn" data-lang="English">English</button>
                            <button class="language-btn" data-lang="æ—¥æœ¬èª">æ—¥æœ¬èª</button>
                            <button class="language-btn" data-lang="FranÃ§ais">FranÃ§ais</button>
                            <button class="language-btn" data-lang="Deutsch">Deutsch</button>
                        </div>
                    </div>

                    <!-- å¼€å§‹åˆ†ææŒ‰é’® -->
                    <button id="analyze-btn" class="glow-button text-lg px-8 py-4 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <span class="flex items-center justify-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            å¼€å§‹AIåˆ†æ
                        </span>
                    </button>
                </div>
            </div>

            <!-- åˆ†æè¿›åº¦åŒºåŸŸ -->
            <div id="analysis-section" class="mb-8 hidden">
                <!-- è®ºæ–‡åˆ†è§£è¿‡ç¨‹ -->
                <div id="chunking-section" class="cyber-card p-6 mb-6">
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-white mb-2" style="font-family: 'Orbitron', monospace;">ğŸ“„ è®ºæ–‡æ™ºèƒ½åˆ†è§£</h3>
                        <p class="text-slate-400">æ­£åœ¨å°†è®ºæ–‡æ‹†åˆ†ä¸ºè¯­ä¹‰å—ï¼Œä¾¿äºAIæ·±åº¦ç†è§£</p>
                    </div>
                    
                    <!-- åˆ†è§£å¯è§†åŒ– -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- åŸæ–‡æ¡£ç»“æ„ -->
                        <div class="space-y-4">
                            <h4 class="text-cyan-400 font-semibold mb-3">ğŸ“– åŸå§‹æ–‡æ¡£ç»“æ„</h4>
                            <div id="document-structure" class="space-y-2">
                                <div class="doc-section border-l-4 border-blue-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="title">
                                    <div class="text-white font-medium">æ ‡é¢˜ä¸ä½œè€…ä¿¡æ¯</div>
                                    <div class="text-slate-400 text-sm">Deep Learning for Academic Paper Analysis...</div>
                                </div>
                                <div class="doc-section border-l-4 border-purple-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="abstract">
                                    <div class="text-white font-medium">æ‘˜è¦</div>
                                    <div class="text-slate-400 text-sm">Abstract section with key findings...</div>
                                </div>
                                <div class="doc-section border-l-4 border-green-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="introduction">
                                    <div class="text-white font-medium">å¼•è¨€</div>
                                    <div class="text-slate-400 text-sm">Introduction and background...</div>
                                </div>
                                <div class="doc-section border-l-4 border-yellow-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="methodology">
                                    <div class="text-white font-medium">æ–¹æ³•è®º</div>
                                    <div class="text-slate-400 text-sm">Research methods and approach...</div>
                                </div>
                                <div class="doc-section border-l-4 border-red-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="results">
                                    <div class="text-white font-medium">å®éªŒç»“æœ</div>
                                    <div class="text-slate-400 text-sm">Results and findings...</div>
                                </div>
                                <div class="doc-section border-l-4 border-pink-400 pl-4 py-2 bg-slate-800/30 rounded-r transition-all duration-500" data-section="conclusion">
                                    <div class="text-white font-medium">ç»“è®º</div>
                                    <div class="text-slate-400 text-sm">Conclusions and future work...</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ™ºèƒ½åˆ†å—ç»“æœ -->
                        <div class="space-y-4">
                            <h4 class="text-cyan-400 font-semibold mb-3">ğŸ§© æ™ºèƒ½è¯­ä¹‰åˆ†å—</h4>
                            <div id="chunk-container" class="space-y-2 min-h-[300px]">
                                <!-- åŠ¨æ€ç”Ÿæˆçš„chunkå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                            </div>
                            
                            <!-- åˆ†å—ç»Ÿè®¡ -->
                            <div class="mt-4 p-3 bg-slate-900/50 rounded-lg border border-slate-700">
                                <div class="grid grid-cols-3 gap-4 text-center">
                                    <div>
                                        <div class="text-2xl font-bold text-cyan-400" id="chunk-count">0</div>
                                        <div class="text-xs text-slate-400">è¯­ä¹‰å—</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold text-green-400" id="avg-chunk-size">0</div>
                                        <div class="text-xs text-slate-400">å¹³å‡å¤§å°</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold text-purple-400" id="total-tokens">0</div>
                                        <div class="text-xs text-slate-400">æ€»Tokenæ•°</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- AIåˆ†æè¿›åº¦ -->
                <div class="cyber-card p-6">
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-white mb-2" style="font-family: 'Orbitron', monospace;">ğŸ¤– AIæ·±åº¦åˆ†æ</h3>
                        <p class="text-slate-400">åŸºäºè¯­ä¹‰åˆ†å—ï¼Œè¿›è¡Œå¤šç»´åº¦æ™ºèƒ½åˆ†æ</p>
                    </div>
                    
                    <!-- è¿›åº¦æ˜¾ç¤º -->
                    <div class="space-y-4">
                        <div class="analysis-step" data-step="extract">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-white font-medium">ğŸ“„ å†…å®¹ç†è§£ä¸å‘é‡åŒ–</span>
                                <span class="step-status text-slate-400">å¾…å¤„ç†</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="analysis-step" data-step="snapshot">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-white font-medium">ğŸ“Š ç”Ÿæˆå­¦æœ¯å¿«ç…§</span>
                                <span class="step-status text-slate-400">å¾…å¤„ç†</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="analysis-step" data-step="methodology">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-white font-medium">ğŸ”¬ æ–¹æ³•è®ºæ·±åº¦åˆ†æ</span>
                                <span class="step-status text-slate-400">å¾…å¤„ç†</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="analysis-step" data-step="evaluation">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-white font-medium">ğŸ’ æ„å»ºçŸ¥è¯†å›¾è°±</span>
                                <span class="step-status text-slate-400">å¾…å¤„ç†</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç¥ç»ç½‘ç»œå›¾è°± -->
            <div id="neural-network-section" class="mb-8 hidden">
                <div class="cyber-card p-6">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-bold text-white mb-2" style="font-family: 'Orbitron', monospace;">ğŸ§  è®ºæ–‡çŸ¥è¯†ç¥ç»ç½‘ç»œ</h3>
                        <p class="text-slate-400">åŸºäºAIåˆ†ææ„å»ºçš„å¤šç»´çŸ¥è¯†å›¾è°±ï¼Œç‚¹å‡»èŠ‚ç‚¹æ¢ç´¢ç›¸å…³å†…å®¹</p>
                    </div>
                    
                    <!-- ç½‘ç»œå›¾è°±å®¹å™¨ -->
                    <div class="relative">
                        <canvas id="neural-network-canvas" class="w-full h-96 bg-slate-900/30 rounded-lg border border-slate-700"></canvas>
                        
                        <!-- èŠ‚ç‚¹ä¿¡æ¯é¢æ¿ -->
                        <div id="node-info-panel" class="absolute top-4 right-4 w-80 bg-slate-800/90 backdrop-blur-sm border border-slate-600 rounded-lg p-4 hidden">
                            <div class="flex items-center justify-between mb-3">
                                <h4 id="node-title" class="text-white font-bold">èŠ‚ç‚¹ä¿¡æ¯</h4>
                                <button id="close-panel" class="text-slate-400 hover:text-white">âœ•</button>
                            </div>
                            <div id="node-content" class="text-slate-300 text-sm"></div>
                            <button id="search-node" class="mt-3 w-full glow-button text-sm py-2">ğŸš€ æ™ºèƒ½çŸ¥è¯†æ‹“å±•</button>
                        </div>
                        
                        <!-- æœç´¢ç»“æœæ¨¡æ€æ¡† -->
                        <div id="search-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center">
                            <div class="cyber-card max-w-4xl w-full max-h-[80vh] overflow-hidden m-4">
                                <div class="flex items-center justify-between p-6 border-b border-slate-700">
                                    <h3 class="text-xl font-bold text-white">ğŸ” äº’è”ç½‘æœç´¢ç»“æœ</h3>
                                    <button id="close-search-modal" class="text-slate-400 hover:text-white text-xl">âœ•</button>
                                </div>
                                <div id="search-results" class="p-6 overflow-y-auto max-h-[60vh]">
                                    <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å›¾è°±æ§åˆ¶é¢æ¿ -->
                    <div class="mt-6 flex flex-wrap gap-4 justify-center">
                        <button id="reset-network" class="cyber-button">ğŸ”„ é‡ç½®è§†å›¾</button>
                        <button id="toggle-labels" class="cyber-button">ğŸ·ï¸ åˆ‡æ¢æ ‡ç­¾</button>
                        <button id="auto-layout" class="cyber-button">âœ¨ è‡ªåŠ¨å¸ƒå±€</button>
                        <button id="export-network" class="cyber-button">ğŸ’¾ å¯¼å‡ºå›¾è°±</button>
                    </div>
                    
                    <!-- å›¾ä¾‹ -->
                    <div class="mt-4 flex flex-wrap gap-6 justify-center text-sm">
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-blue-400 rounded-full mr-2"></div>
                            <span class="text-slate-300">æ ¸å¿ƒæ¦‚å¿µ</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-purple-400 rounded-full mr-2"></div>
                            <span class="text-slate-300">ç ”ç©¶æ–¹æ³•</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-green-400 rounded-full mr-2"></div>
                            <span class="text-slate-300">å®éªŒç»“æœ</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-yellow-400 rounded-full mr-2"></div>
                            <span class="text-slate-300">å…³é”®æœ¯è¯­</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-red-400 rounded-full mr-2"></div>
                            <span class="text-slate-300">åº”ç”¨é¢†åŸŸ</span>
                        </div>
                    </div>
                </div>
            </div>



            <!-- å¯¹è¯åŒºåŸŸ -->
            <div id="chat-section" class="hidden">
                <div class="cyber-card p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-400 to-purple-500 rounded-lg flex items-center justify-center mr-4 animate-pulse">
                            <span class="text-xl">ğŸ’¬</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white" style="font-family: 'Orbitron', monospace;">ä¸è®ºæ–‡å¯¹è¯</h3>
                            <p class="text-slate-400">åŸºäºåˆ†æç»“æœï¼Œæ·±å…¥æ¢è®¨è®ºæ–‡å†…å®¹</p>
                        </div>
                    </div>

                    <!-- èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
                    <div id="chat-messages" class="h-96 overflow-y-auto mb-4 p-4 bg-slate-900/30 rounded-lg border border-slate-700/50">
                        <!-- æ¶ˆæ¯å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>

                    <!-- å¿«æ·æ“ä½œ -->
                    <div class="mb-4 p-4 bg-slate-800/30 rounded-lg border border-slate-600/30">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="text-sm font-semibold text-slate-300" style="font-family: 'Orbitron', monospace;">
                                <i class="fas fa-bolt mr-2 text-yellow-400"></i>å¿«æ·æ“ä½œ
                            </h4>
                            <div class="flex space-x-2 text-xs">
                                <span class="px-2 py-1 bg-cyan-500/20 text-cyan-300 rounded">Ctrl+R</span>
                                <span class="px-2 py-1 bg-orange-500/20 text-orange-300 rounded">Ctrl+N</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
                            <button onclick="app.restartAnalysis()" class="px-3 py-2 bg-cyan-500/10 border border-cyan-500/30 rounded text-cyan-300 hover:bg-cyan-500/20 transition-all text-sm">
                                <i class="fas fa-refresh mr-2"></i>é‡æ–°åˆ†æ
                            </button>
                            <button onclick="app.uploadNewDocument()" class="px-3 py-2 bg-orange-500/10 border border-orange-500/30 rounded text-orange-300 hover:bg-orange-500/20 transition-all text-sm">
                                <i class="fas fa-plus mr-2"></i>æ–°æ–‡æ¡£
                            </button>
                            <button onclick="app.exportCurrentSession()" class="px-3 py-2 bg-purple-500/10 border border-purple-500/30 rounded text-purple-300 hover:bg-purple-500/20 transition-all text-sm">
                                <i class="fas fa-download mr-2"></i>å¯¼å‡º
                            </button>
                        </div>
                    </div>

                    <!-- è¾“å…¥åŒºåŸŸ -->
                    <div class="flex space-x-3">
                        <input type="text" id="chat-input" class="flex-1 cyber-input" placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜...">
                        <button id="send-btn" class="glow-button px-6">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // åˆ†å—æ•°æ®
        const mockChunkData = [
            { id: 1, type: 'title', content: 'æ ‡é¢˜: Deep Learning for Academic Paper Analysis: A Comprehensive Framework', tokens: 142 },
            { id: 2, type: 'abstract', content: 'æ‘˜è¦: This paper presents a comprehensive framework for academic paper analysis using deep learning techniques...', tokens: 256 },
            { id: 3, type: 'introduction', content: 'å¼•è¨€: With the exponential growth of academic literature, there is an urgent need for automated analysis tools...', tokens: 312 },
            { id: 4, type: 'methodology', content: 'æ–¹æ³•: We propose a multi-modal approach that combines text analysis, graph neural networks, and attention mechanisms...', tokens: 387 },
            { id: 5, type: 'experiment', content: 'å®éªŒ: Our experiments were conducted on a dataset of 1 million academic papers across various domains...', tokens: 298 },
            { id: 6, type: 'results', content: 'ç»“æœ: The proposed framework achieves 89.3% accuracy in paper classification and generates meaningful insights...', tokens: 275 },
            { id: 7, type: 'discussion', content: 'è®¨è®º: The results demonstrate the effectiveness of our approach in handling multi-modal academic content...', tokens: 234 },
            { id: 8, type: 'conclusion', content: 'ç»“è®º: This work provides a foundation for automated academic paper analysis and opens new research directions...', tokens: 198 },
            { id: 9, type: 'references', content: 'å‚è€ƒæ–‡çŒ®: [1] Smith, J. et al. (2023). Deep Learning for Text Analysis. [2] Brown, A. (2022). Academic Mining...', tokens: 156 }
        ];

        // ç¥ç»ç½‘ç»œèŠ‚ç‚¹æ•°æ®
        const mockNetworkData = {
            nodes: [
                { id: 'deep_learning', label: 'Deep Learning', type: 'concept', x: 400, y: 200, color: '#60a5fa', description: 'æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„å­é›†ï¼Œä½¿ç”¨å¤šå±‚ç¥ç»ç½‘ç»œæ¥å­¦ä¹ æ•°æ®çš„å¤æ‚æ¨¡å¼' },
                { id: 'nlp', label: 'NLP', type: 'method', x: 300, y: 150, color: '#a855f7', description: 'è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ï¼Œç”¨äºç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€' },
                { id: 'transformer', label: 'Transformer', type: 'method', x: 500, y: 150, color: '#a855f7', description: 'Transformeræ¶æ„ï¼ŒåŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ç¥ç»ç½‘ç»œæ¨¡å‹' },
                { id: 'bert', label: 'BERT', type: 'result', x: 250, y: 100, color: '#22d3ee', description: 'BERTæ˜¯åŸºäºTransformerçš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹' },
                { id: 'attention', label: 'Attention', type: 'term', x: 550, y: 100, color: '#eab308', description: 'æ³¨æ„åŠ›æœºåˆ¶å…è®¸æ¨¡å‹å…³æ³¨è¾“å…¥åºåˆ—çš„ä¸åŒéƒ¨åˆ†' },
                { id: 'academic_analysis', label: 'Academic Analysis', type: 'application', x: 400, y: 300, color: '#ef4444', description: 'å­¦æœ¯è®ºæ–‡åˆ†æçš„è‡ªåŠ¨åŒ–å¤„ç†æŠ€æœ¯' },
                { id: 'text_mining', label: 'Text Mining', type: 'method', x: 200, y: 250, color: '#a855f7', description: 'ä»éç»“æ„åŒ–æ–‡æœ¬ä¸­æå–æœ‰ç”¨ä¿¡æ¯çš„è¿‡ç¨‹' },
                { id: 'knowledge_graph', label: 'Knowledge Graph', type: 'result', x: 600, y: 250, color: '#22d3ee', description: 'çŸ¥è¯†å›¾è°±ç”¨äºè¡¨ç¤ºå®ä½“ä¹‹é—´çš„å…³ç³»' },
                { id: 'citation_analysis', label: 'Citation Analysis', type: 'application', x: 300, y: 350, color: '#ef4444', description: 'å¼•ç”¨åˆ†æç”¨äºè¯„ä¼°å­¦æœ¯å½±å“åŠ›' },
                { id: 'semantic_search', label: 'Semantic Search', type: 'application', x: 500, y: 350, color: '#ef4444', description: 'è¯­ä¹‰æœç´¢åŸºäºå†…å®¹å«ä¹‰è€Œéå…³é”®è¯åŒ¹é…' }
            ],
            edges: [
                { from: 'deep_learning', to: 'nlp', strength: 0.8 },
                { from: 'deep_learning', to: 'transformer', strength: 0.9 },
                { from: 'nlp', to: 'bert', strength: 0.7 },
                { from: 'transformer', to: 'bert', strength: 0.8 },
                { from: 'transformer', to: 'attention', strength: 0.9 },
                { from: 'deep_learning', to: 'academic_analysis', strength: 0.6 },
                { from: 'nlp', to: 'text_mining', strength: 0.7 },
                { from: 'academic_analysis', to: 'citation_analysis', strength: 0.5 },
                { from: 'academic_analysis', to: 'semantic_search', strength: 0.6 },
                { from: 'text_mining', to: 'knowledge_graph', strength: 0.4 },
                { from: 'knowledge_graph', to: 'semantic_search', strength: 0.5 }
            ]
        };



        // çŠ¶æ€ç®¡ç†
        class LiteratureJuicerApp {
            constructor() {
                this.currentStep = 'upload'
                this.selectedLanguage = 'ä¸­æ–‡'
                this.selectedFile = null
                this.analysisProgress = {
                    extract: 0,
                    snapshot: 0,
                    methodology: 0,
                    evaluation: 0
                }
                this.init()
            }

            init() {
                this.setupEventListeners()
                this.setupKeyboardShortcuts()
                this.setupFileUpload()
                this.setupLanguageSelection()
                this.setupChat()
                this.setupNeuralNetwork()
            }

            setupEventListeners() {
                // åˆ†ææŒ‰é’®
                document.getElementById('analyze-btn').addEventListener('click', () => {
                    if (this.selectedFile) {
                        this.startAnalysis()
                    }
                })

                // å‘é€æ¶ˆæ¯æŒ‰é’®
                document.getElementById('send-btn').addEventListener('click', () => {
                    this.sendMessage()
                })

                // è¾“å…¥æ¡†å›è½¦
                document.getElementById('chat-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendMessage()
                    }
                })
            }

            setupFileUpload() {
                const dropZone = document.getElementById('drop-zone')
                const fileInput = document.getElementById('file-input')

                // ç‚¹å‡»ä¸Šä¼ 
                dropZone.addEventListener('click', () => {
                    fileInput.click()
                })

                // æ–‡ä»¶é€‰æ‹©
                fileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0]
                    if (file) {
                        this.handleFileSelect(file)
                    }
                })

                // æ‹–æ‹½ä¸Šä¼ 
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault()
                    dropZone.style.borderColor = '#00d4ff'
                    dropZone.style.backgroundColor = 'rgba(30, 41, 59, 0.3)'
                })

                dropZone.addEventListener('dragleave', (e) => {
                    e.preventDefault()
                    dropZone.style.borderColor = 'rgb(71, 85, 105)'
                    dropZone.style.backgroundColor = 'transparent'
                })

                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault()
                    dropZone.style.borderColor = 'rgb(71, 85, 105)'
                    dropZone.style.backgroundColor = 'transparent'
                    
                    const files = e.dataTransfer.files
                    if (files.length > 0) {
                        this.handleFileSelect(files[0])
                    }
                })
            }

            handleFileSelect(file) {
                // æ–‡ä»¶ç±»å‹éªŒè¯
                const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain']
                if (!allowedTypes.includes(file.type)) {
                    this.showNotification('è¯·é€‰æ‹© PDFã€DOCã€DOCX æˆ– TXT æ ¼å¼çš„æ–‡ä»¶', 'error')
                    return
                }

                // æ–‡ä»¶å¤§å°éªŒè¯ (50MB)
                if (file.size > 50 * 1024 * 1024) {
                    this.showNotification('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 50MB', 'error')
                    return
                }

                this.selectedFile = file
                
                // æ›´æ–°UI
                const dropZone = document.getElementById('drop-zone')
                dropZone.innerHTML = `
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto bg-green-500/20 rounded-full flex items-center justify-center mb-4">
                            <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <p class="text-green-400 text-lg font-semibold">${file.name}</p>
                        <p class="text-slate-400 text-sm">${this.formatFileSize(file.size)} â€¢ ${file.type.split('/')[1].toUpperCase()}</p>
                        <button class="mt-3 text-blue-400 hover:text-white transition-colors" onclick="app.clearFile()">æ›´æ¢æ–‡ä»¶</button>
                    </div>
                `

                // å¯ç”¨åˆ†ææŒ‰é’®
                document.getElementById('analyze-btn').disabled = false
                
                this.showNotification('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼', 'success')
            }

            clearFile() {
                this.selectedFile = null
                document.getElementById('file-input').value = ''
                document.getElementById('analyze-btn').disabled = true
                
                // é‡ç½®ä¸Šä¼ åŒºåŸŸ
                const dropZone = document.getElementById('drop-zone')
                dropZone.innerHTML = `
                    <div class="text-center">
                        <svg class="w-16 h-16 mx-auto text-slate-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <p class="text-slate-300 text-lg mb-2">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©</p>
                        <p class="text-slate-500 text-sm">æœ€å¤§æ”¯æŒ 50MB</p>
                    </div>
                `
            }

            setupLanguageSelection() {
                const languageButtons = document.querySelectorAll('.language-btn')
                
                languageButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        // ç§»é™¤å…¶ä»–æŒ‰é’®çš„activeçŠ¶æ€
                        languageButtons.forEach(b => b.classList.remove('active'))
                        // æ·»åŠ å½“å‰æŒ‰é’®çš„activeçŠ¶æ€
                        btn.classList.add('active')
                        this.selectedLanguage = btn.dataset.lang
                    })
                })
            }

            startAnalysis() {
                // éšè—ä¸Šä¼ åŒºåŸŸï¼Œæ˜¾ç¤ºåˆ†æåŒºåŸŸ
                document.getElementById('upload-section').classList.add('hidden')
                document.getElementById('analysis-section').classList.remove('hidden')

                this.showNotification(`å¼€å§‹åˆ†æ "${this.selectedFile.name}"`, 'info')

                // æ¨¡æ‹Ÿåˆ†æè¿‡ç¨‹
                this.simulateAnalysis()
            }

            async simulateAnalysis() {
                // é¦–å…ˆè¿›è¡Œåˆ†å—å¤„ç†
                await this.simulateChunking()
                
                // ç„¶åè¿›è¡ŒAIåˆ†æ
                const steps = ['extract', 'snapshot', 'methodology', 'evaluation']
                
                for (let i = 0; i < steps.length; i++) {
                    const step = steps[i]
                    const stepElement = document.querySelector(`[data-step="${step}"]`)
                    const statusElement = stepElement.querySelector('.step-status')
                    const progressElement = stepElement.querySelector('.progress-fill')

                    // æ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­
                    statusElement.textContent = 'å¤„ç†ä¸­...'
                    statusElement.style.color = '#00d4ff'

                    // æ¨¡æ‹Ÿè¿›åº¦
                    await this.animateProgress(progressElement, 0, 100, 2000)

                    // æ›´æ–°çŠ¶æ€ä¸ºå®Œæˆ
                    statusElement.textContent = 'âœ“ å®Œæˆ'
                    statusElement.style.color = '#22c55e'

                    // çŸ­æš‚å»¶è¿Ÿ
                    await this.delay(500)
                }

                // åˆ†æå®Œæˆï¼Œæ˜¾ç¤ºç¥ç»ç½‘ç»œå›¾è°±
                this.showNeuralNetwork()
            }

            async simulateChunking() {
                const docSections = document.querySelectorAll('.doc-section')
                const chunkContainer = document.getElementById('chunk-container')
                let totalTokens = 0
                
                // é€ä¸ªå¤„ç†æ–‡æ¡£èŠ‚ç‚¹
                for (let i = 0; i < docSections.length; i++) {
                    const section = docSections[i]
                    section.classList.add('processing')
                    
                    await this.delay(800)
                    
                    // ç”Ÿæˆå¯¹åº”çš„åˆ†å—
                    const chunks = this.generateChunksForSection(section.dataset.section)
                    for (const chunk of chunks) {
                        await this.addChunkToContainer(chunkContainer, chunk)
                        totalTokens += chunk.tokens
                        this.updateChunkStats(i + 1, totalTokens)
                        await this.delay(300)
                    }
                    
                    section.classList.remove('processing')
                    section.classList.add('completed')
                }
                
                await this.delay(1000)
            }

            generateChunksForSection(sectionType) {
                return mockChunkData.filter(chunk => 
                    chunk.type === sectionType || 
                    (sectionType === 'title' && chunk.type === 'title') ||
                    (sectionType === 'abstract' && chunk.type === 'abstract') ||
                    (sectionType === 'introduction' && chunk.type === 'introduction') ||
                    (sectionType === 'methodology' && ['methodology', 'experiment'].includes(chunk.type)) ||
                    (sectionType === 'results' && ['results', 'discussion'].includes(chunk.type)) ||
                    (sectionType === 'conclusion' && ['conclusion', 'references'].includes(chunk.type))
                )
            }

            async addChunkToContainer(container, chunk) {
                const chunkDiv = document.createElement('div')
                chunkDiv.className = 'chunk-item'
                chunkDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-1">
                        <span class="text-cyan-400 text-xs font-medium">Chunk ${chunk.id}</span>
                        <span class="text-slate-500 text-xs">${chunk.tokens} tokens</span>
                    </div>
                    <div class="text-slate-300 text-xs line-clamp-2">${chunk.content}</div>
                `
                
                chunkDiv.addEventListener('click', () => {
                    document.querySelectorAll('.chunk-item').forEach(c => c.classList.remove('active'))
                    chunkDiv.classList.add('active')
                })
                
                container.appendChild(chunkDiv)
                
                // æ·»åŠ åŠ¨ç”»
                chunkDiv.style.opacity = '0'
                chunkDiv.style.transform = 'translateY(20px)'
                
                requestAnimationFrame(() => {
                    chunkDiv.style.transition = 'all 0.3s ease'
                    chunkDiv.style.opacity = '1'
                    chunkDiv.style.transform = 'translateY(0)'
                })
            }

            updateChunkStats(chunkCount, totalTokens) {
                const avgSize = Math.round(totalTokens / chunkCount)
                
                document.getElementById('chunk-count').textContent = chunkCount
                document.getElementById('avg-chunk-size').textContent = avgSize
                document.getElementById('total-tokens').textContent = totalTokens.toLocaleString()
                
                // æ·»åŠ æ•°å­—åŠ¨ç”»
                document.getElementById('chunk-count').classList.add('count-up')
                document.getElementById('avg-chunk-size').classList.add('count-up')
                document.getElementById('total-tokens').classList.add('count-up')
            }

            async animateProgress(element, from, to, duration) {
                return new Promise(resolve => {
                    const startTime = Date.now()
                    const animate = () => {
                        const elapsed = Date.now() - startTime
                        const progress = Math.min(elapsed / duration, 1)
                        const value = from + (to - from) * progress
                        
                        element.style.width = `${value}%`
                        
                        if (progress < 1) {
                            requestAnimationFrame(animate)
                        } else {
                            resolve()
                        }
                    }
                    animate()
                })
            }

            async showNeuralNetwork() {
                // æ˜¾ç¤ºè¿‡æ¸¡æç¤º
                this.showNotification('æ­£åœ¨æ„å»ºçŸ¥è¯†å›¾è°±...', 'info')
                
                // æ·»åŠ è¿‡æ¸¡åŠ¨ç”»åˆ°åˆ†æåŒºåŸŸ
                const analysisSection = document.getElementById('analysis-section')
                analysisSection.style.transition = 'all 1s ease-out'
                analysisSection.style.transform = 'translateY(-20px)'
                analysisSection.style.opacity = '0.5'
                
                await this.delay(1500)
                
                // æ˜¾ç¤ºæ„å»ºè¿‡ç¨‹æç¤º
                this.showNotification('åŸºäºåˆ†æç»“æœç”ŸæˆçŸ¥è¯†ç½‘ç»œ...', 'info')
                
                // æ·»åŠ çŸ¥è¯†å›¾è°±æ„å»ºçš„è¿‡æ¸¡åŒºåŸŸ
                this.showNetworkTransition()
                
                await this.delay(2000)
                
                // å¹³æ»‘éšè—åˆ†æåŒºåŸŸï¼Œæ˜¾ç¤ºç¥ç»ç½‘ç»œ
                analysisSection.classList.add('hidden')
                document.getElementById('neural-network-section').classList.remove('hidden')

                // æ·»åŠ ç¥ç»ç½‘ç»œåŒºåŸŸçš„å…¥åœºåŠ¨ç”»
                const networkSection = document.getElementById('neural-network-section')
                networkSection.style.opacity = '0'
                networkSection.style.transform = 'translateY(30px)'
                
                // åˆå§‹åŒ–ç¥ç»ç½‘ç»œå›¾è°±
                this.initializeNeuralNetwork()
                
                // åŠ¨ç”»æ˜¾ç¤ºç¥ç»ç½‘ç»œ
                setTimeout(() => {
                    networkSection.style.transition = 'all 1s ease-out'
                    networkSection.style.opacity = '1'
                    networkSection.style.transform = 'translateY(0)'
                }, 100)

                // æ˜¾ç¤ºå®Œæˆæç¤ºå’Œå¯¹è¯åŒºåŸŸ
                setTimeout(() => {
                    this.showNotification('ğŸ§  çŸ¥è¯†å›¾è°±æ„å»ºå®Œæˆï¼ç‚¹å‡»èŠ‚ç‚¹æ·±åº¦æ¢ç´¢', 'success')
                    
                    // å»¶è¿Ÿæ˜¾ç¤ºå¯¹è¯åŒºåŸŸ
                    setTimeout(() => {
                        document.getElementById('chat-section').classList.remove('hidden')
                        this.addSuggestedQuestions()
                        this.showControlButtons()
                    }, 1500)
                }, 2000)
            }

            showNetworkTransition() {
                // åœ¨åˆ†æåŒºåŸŸä¸‹æ–¹æ·»åŠ è¿‡æ¸¡æç¤º
                const transitionDiv = document.createElement('div')
                transitionDiv.id = 'network-transition'
                transitionDiv.className = 'cyber-card p-6 mb-8'
                transitionDiv.innerHTML = `
                    <div class="text-center">
                        <div class="mb-6">
                            <div class="w-16 h-16 mx-auto bg-neon-gradient rounded-full flex items-center justify-center animate-pulse">
                                <span class="text-2xl">ğŸ§ </span>
                            </div>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-4" style="font-family: 'Orbitron', monospace;">æ„å»ºçŸ¥è¯†ç¥ç»ç½‘ç»œ</h3>
                        <p class="text-slate-400 mb-4">æ­£åœ¨åŸºäºè®ºæ–‡åˆ†æç»“æœæ„å»ºå¤šç»´çŸ¥è¯†å›¾è°±...</p>
                        <div class="flex justify-center space-x-2">
                            <div class="w-2 h-2 bg-cyan-400 rounded-full animate-bounce"></div>
                            <div class="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                            <div class="w-2 h-2 bg-green-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        </div>
                        <div class="mt-4 text-sm text-slate-500">
                            <div class="loading-text">æ­£åœ¨æå–æ ¸å¿ƒæ¦‚å¿µ</div>
                        </div>
                    </div>
                `
                
                const analysisSection = document.getElementById('analysis-section')
                analysisSection.parentNode.insertBefore(transitionDiv, analysisSection.nextSibling)
                
                // åŠ¨æ€æ›´æ–°åŠ è½½æ–‡æœ¬
                let loadingTexts = [
                    'æ­£åœ¨æå–æ ¸å¿ƒæ¦‚å¿µ...',
                    'æ­£åœ¨å»ºç«‹æ¦‚å¿µå…³ç³»...',
                    'æ­£åœ¨ä¼˜åŒ–ç½‘ç»œå¸ƒå±€...',
                    'æ­£åœ¨ç”Ÿæˆäº¤äº’èŠ‚ç‚¹...'
                ]
                let currentTextIndex = 0
                
                const loadingTextElement = transitionDiv.querySelector('.loading-text')
                const textInterval = setInterval(() => {
                    currentTextIndex = (currentTextIndex + 1) % loadingTexts.length
                    loadingTextElement.textContent = loadingTexts[currentTextIndex]
                }, 800)
                
                // 2ç§’åç§»é™¤è¿‡æ¸¡å…ƒç´ 
                setTimeout(() => {
                    clearInterval(textInterval)
                    transitionDiv.style.transition = 'all 0.5s ease-out'
                    transitionDiv.style.opacity = '0'
                    transitionDiv.style.transform = 'translateY(-20px)'
                    setTimeout(() => {
                        if (transitionDiv.parentNode) {
                            transitionDiv.parentNode.removeChild(transitionDiv)
                        }
                    }, 500)
                }, 2000)
            }

            setupChat() {
                // é¢„è®¾é—®é¢˜æŒ‰é’®
            }

            setupNeuralNetwork() {
                // è®¾ç½®ç¥ç»ç½‘ç»œæ§åˆ¶æŒ‰é’®
                document.getElementById('reset-network').addEventListener('click', () => {
                    this.resetNetworkView()
                })
                
                document.getElementById('toggle-labels').addEventListener('click', () => {
                    this.toggleNodeLabels()
                })
                
                document.getElementById('auto-layout').addEventListener('click', () => {
                    this.autoLayoutNetwork()
                })
                
                document.getElementById('export-network').addEventListener('click', () => {
                    this.exportNetwork()
                })

                // è®¾ç½®é¢æ¿æ§åˆ¶
                document.getElementById('close-panel').addEventListener('click', () => {
                    document.getElementById('node-info-panel').classList.add('hidden')
                })

                document.getElementById('search-node').addEventListener('click', () => {
                    this.searchNodeContent()
                })

                document.getElementById('close-search-modal').addEventListener('click', () => {
                    document.getElementById('search-modal').classList.add('hidden')
                })
            }

            initializeNeuralNetwork() {
                const canvas = document.getElementById('neural-network-canvas')
                const ctx = canvas.getContext('2d')
                
                // è®¾ç½®ç”»å¸ƒå°ºå¯¸
                canvas.width = canvas.offsetWidth * 2
                canvas.height = canvas.offsetHeight * 2
                ctx.scale(2, 2)
                
                this.networkCanvas = canvas
                this.networkCtx = ctx
                this.networkData = JSON.parse(JSON.stringify(mockNetworkData))
                this.selectedNode = null
                this.showLabels = true
                this.isDragging = false
                this.dragNode = null
                this.nodeAnimationProgress = 0 // æ·»åŠ èŠ‚ç‚¹åŠ¨ç”»è¿›åº¦
                
                // æ·»åŠ é¼ æ ‡äº‹ä»¶
                canvas.addEventListener('mousedown', (e) => this.onMouseDown(e))
                canvas.addEventListener('mousemove', (e) => this.onMouseMove(e))
                canvas.addEventListener('mouseup', (e) => this.onMouseUp(e))
                canvas.addEventListener('click', (e) => this.onNodeClick(e))
                
                // å¼€å§‹åŠ¨ç”»å¾ªç¯
                this.animateNetwork()
                
                // å¯åŠ¨èŠ‚ç‚¹é€ä¸ªå‡ºç°çš„åŠ¨ç”»
                this.animateNodesAppearance()
            }

            async animateNodesAppearance() {
                const totalNodes = this.networkData.nodes.length
                const animationDuration = 3000 // 3ç§’å†…å®Œæˆæ‰€æœ‰èŠ‚ç‚¹å‡ºç°
                const nodeDelay = animationDuration / totalNodes
                
                for (let i = 0; i < totalNodes; i++) {
                    await this.delay(nodeDelay)
                    this.nodeAnimationProgress = (i + 1) / totalNodes
                    
                    // åªæ˜¾ç¤ºéƒ¨åˆ†é‡è¦èŠ‚ç‚¹çš„æç¤ºï¼Œé¿å…é€šçŸ¥è¿‡å¤š
                    const node = this.networkData.nodes[i]
                    if (i === 0 || i === Math.floor(totalNodes / 2) || i === totalNodes - 1) {
                        this.showNotification(`ğŸ§  å‘ç°æ ¸å¿ƒæ¦‚å¿µ: ${node.label}`, 'info', 1500)
                    }
                }
                
                // å®Œæˆåæ˜¾ç¤ºæ€»ç»“é€šçŸ¥
                this.showNotification(`âœ¨ çŸ¥è¯†å›¾è°±æ„å»ºå®Œæˆï¼Œå…±å‘ç° ${totalNodes} ä¸ªæ¦‚å¿µèŠ‚ç‚¹`, 'success', 2000)
            }

            animateNetwork() {
                this.drawNetwork()
                requestAnimationFrame(() => this.animateNetwork())
            }

            drawNetwork() {
                const ctx = this.networkCtx
                const canvas = this.networkCanvas
                
                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width / 2, canvas.height / 2)
                
                // è®¡ç®—å½“å‰åº”è¯¥æ˜¾ç¤ºçš„èŠ‚ç‚¹æ•°é‡
                const totalNodes = this.networkData.nodes.length
                const visibleNodeCount = Math.floor(this.nodeAnimationProgress * totalNodes)
                const visibleNodes = this.networkData.nodes.slice(0, visibleNodeCount)
                
                // ç»˜åˆ¶è¿æ¥çº¿ï¼ˆåªç»˜åˆ¶å¯è§èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼‰
                this.networkData.edges.forEach(edge => {
                    const fromNode = visibleNodes.find(n => n.id === edge.from)
                    const toNode = visibleNodes.find(n => n.id === edge.to)
                    
                    if (fromNode && toNode) {
                        ctx.strokeStyle = `rgba(0, 212, 255, ${edge.strength * 0.6})`
                        ctx.lineWidth = edge.strength * 3
                        ctx.beginPath()
                        ctx.moveTo(fromNode.x, fromNode.y)
                        ctx.lineTo(toNode.x, toNode.y)
                        ctx.stroke()
                    }
                })
                
                // ç»˜åˆ¶å¯è§çš„èŠ‚ç‚¹
                visibleNodes.forEach((node, index) => {
                    const isSelected = this.selectedNode && this.selectedNode.id === node.id
                    let nodeSize = isSelected ? 25 : 20
                    
                    // å¦‚æœæ˜¯æœ€æ–°å‡ºç°çš„èŠ‚ç‚¹ï¼Œæ·»åŠ å…¥åœºåŠ¨ç”»æ•ˆæœ
                    if (index === visibleNodeCount - 1 && this.nodeAnimationProgress < 1) {
                        const progress = (this.nodeAnimationProgress * totalNodes) % 1
                        nodeSize *= (0.3 + 0.7 * progress) // ä»30%å¤§å°ç¼©æ”¾åˆ°100%
                        
                        // æ·»åŠ å‘å…‰æ•ˆæœ
                        const gradient = ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, nodeSize * 2)
                        gradient.addColorStop(0, `${node.color}60`)
                        gradient.addColorStop(1, 'transparent')
                        ctx.fillStyle = gradient
                        ctx.fillRect(node.x - nodeSize * 2, node.y - nodeSize * 2, nodeSize * 4, nodeSize * 4)
                    }
                    
                    // èŠ‚ç‚¹ä¸»ä½“
                    ctx.fillStyle = node.color
                    ctx.beginPath()
                    ctx.arc(node.x, node.y, nodeSize, 0, Math.PI * 2)
                    ctx.fill()
                    
                    // èŠ‚ç‚¹è¾¹æ¡†
                    ctx.strokeStyle = isSelected ? '#ffffff' : 'rgba(255, 255, 255, 0.3)'
                    ctx.lineWidth = isSelected ? 3 : 1
                    ctx.stroke()
                    
                    // èŠ‚ç‚¹æ ‡ç­¾
                    if (this.showLabels) {
                        ctx.fillStyle = '#ffffff'
                        ctx.font = '12px Arial'
                        ctx.textAlign = 'center'
                        ctx.fillText(node.label, node.x, node.y + nodeSize + 15)
                    }
                })
            }

            onMouseDown(e) {
                const rect = this.networkCanvas.getBoundingClientRect()
                const x = e.clientX - rect.left
                const y = e.clientY - rect.top
                
                const clickedNode = this.findNodeAt(x, y)
                if (clickedNode) {
                    this.isDragging = true
                    this.dragNode = clickedNode
                }
            }

            onMouseMove(e) {
                if (this.isDragging && this.dragNode) {
                    const rect = this.networkCanvas.getBoundingClientRect()
                    this.dragNode.x = e.clientX - rect.left
                    this.dragNode.y = e.clientY - rect.top
                }
            }

            onMouseUp(e) {
                this.isDragging = false
                this.dragNode = null
            }

            onNodeClick(e) {
                if (this.isDragging) return
                
                const rect = this.networkCanvas.getBoundingClientRect()
                const x = e.clientX - rect.left
                const y = e.clientY - rect.top
                
                const clickedNode = this.findNodeAt(x, y)
                if (clickedNode) {
                    this.selectedNode = clickedNode
                    this.showNodeInfo(clickedNode)
                }
            }

            findNodeAt(x, y) {
                return this.networkData.nodes.find(node => {
                    const dx = x - node.x
                    const dy = y - node.y
                    return Math.sqrt(dx * dx + dy * dy) <= 25
                })
            }

            showNodeInfo(node) {
                const panel = document.getElementById('node-info-panel')
                const title = document.getElementById('node-title')
                const content = document.getElementById('node-content')
                
                title.textContent = node.label
                content.innerHTML = `
                    <div class="mb-2">
                        <span class="text-cyan-400 text-xs">ç±»å‹:</span> 
                        <span class="text-white">${this.getNodeTypeName(node.type)}</span>
                    </div>
                    <div class="text-slate-300">${node.description}</div>
                `
                
                panel.classList.remove('hidden')
                this.currentSearchNode = node
            }

            getNodeTypeName(type) {
                const typeNames = {
                    concept: 'æ ¸å¿ƒæ¦‚å¿µ',
                    method: 'ç ”ç©¶æ–¹æ³•',
                    result: 'å®éªŒç»“æœ',
                    term: 'å…³é”®æœ¯è¯­',
                    application: 'åº”ç”¨é¢†åŸŸ'
                }
                return typeNames[type] || type
            }

            async searchNodeContent() {
                if (!this.currentSearchNode) return
                
                const modal = document.getElementById('search-modal')
                const results = document.getElementById('search-results')
                
                modal.classList.remove('hidden')
                results.innerHTML = '<div class="text-center text-slate-400">ğŸ” æ­£åœ¨æœç´¢ç›¸å…³å†…å®¹...</div>'
                
                // æ¨¡æ‹Ÿæœç´¢å»¶è¿Ÿ
                await this.delay(2000)
                
                // ç”Ÿæˆæ¨¡æ‹Ÿæœç´¢ç»“æœ
                const searchResults = this.generateSearchResults(this.currentSearchNode)
                results.innerHTML = searchResults
            }

            generateSearchResults(node) {
                const mockResults = [
                    {
                        title: `${node.label} - ç»´åŸºç™¾ç§‘`,
                        url: `https://en.wikipedia.org/wiki/${node.label.replace(' ', '_')}`,
                        snippet: `${node.description} è¿™æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºç§‘å­¦å’Œäººå·¥æ™ºèƒ½é¢†åŸŸéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå¹¿æ³›åº”ç”¨äºå„ç§å®é™…åœºæ™¯ä¸­ã€‚`
                    },
                    {
                        title: `${node.label} æœ€æ–°ç ”ç©¶è¿›å±• - arXiv`,
                        url: `https://arxiv.org/search/?query=${node.label}`,
                        snippet: `æœ€æ–°çš„å­¦æœ¯è®ºæ–‡å’Œç ”ç©¶è¿›å±•ï¼ŒåŒ…å«äº†${node.label}åœ¨ä¸åŒé¢†åŸŸçš„åˆ›æ–°åº”ç”¨å’ŒæŠ€æœ¯çªç ´ã€‚`
                    },
                    {
                        title: `${node.label} å®è·µæŒ‡å— - GitHub`,
                        url: `https://github.com/search?q=${node.label}`,
                        snippet: `å¼€æºé¡¹ç›®å’Œä»£ç å®ç°ï¼Œæä¾›äº†${node.label}çš„å®é™…åº”ç”¨æ¡ˆä¾‹å’Œæœ€ä½³å®è·µã€‚`
                    }
                ]

                return mockResults.map(result => `
                    <div class="mb-6 p-4 bg-slate-800/30 rounded-lg border border-slate-700/50 hover:border-cyan-400/30 transition-colors">
                        <h4 class="text-cyan-400 font-semibold mb-2">${result.title}</h4>
                        <p class="text-slate-300 text-sm mb-2">${result.snippet}</p>
                        <a href="${result.url}" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm">
                            ${result.url} â†’
                        </a>
                    </div>
                `).join('')
            }

            resetNetworkView() {
                this.networkData = JSON.parse(JSON.stringify(mockNetworkData))
                this.selectedNode = null
                document.getElementById('node-info-panel').classList.add('hidden')
                this.showNotification('ç½‘ç»œè§†å›¾å·²é‡ç½®', 'info')
            }

            toggleNodeLabels() {
                this.showLabels = !this.showLabels
                this.showNotification(this.showLabels ? 'æ ‡ç­¾å·²æ˜¾ç¤º' : 'æ ‡ç­¾å·²éšè—', 'info')
            }

            autoLayoutNetwork() {
                this.showNotification('è‡ªåŠ¨å¸ƒå±€å®Œæˆ', 'success')
            }

            exportNetwork() {
                const canvas = this.networkCanvas
                const link = document.createElement('a')
                link.download = 'neural-network.png'
                link.href = canvas.toDataURL()
                link.click()
                
                this.showNotification('å›¾è°±å·²å¯¼å‡º', 'success')
            }

            async addSuggestedQuestions() {
                await this.delay(500) // ç¨ç­‰ä¸€ä¸‹å†æ˜¾ç¤ºå»ºè®®é—®é¢˜
                
                const suggestedQuestions = [
                    "è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦åˆ›æ–°ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ",
                    "ç ”ç©¶æ–¹æ³•æœ‰å“ªäº›ä¼˜åŠ¿å’Œå±€é™æ€§ï¼Ÿ", 
                    "å®éªŒç»“æœæ”¯æŒä½œè€…çš„ç»“è®ºå—ï¼Ÿ",
                    "è¿™é¡¹ç ”ç©¶å¯¹è¯¥é¢†åŸŸæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ",
                    "è®ºæ–‡ä¸­æåˆ°çš„æœªæ¥å·¥ä½œæ–¹å‘æœ‰å“ªäº›ï¼Ÿ"
                ]

                // å…ˆæ˜¾ç¤ºæ‰“å­—æœºæ–‡æœ¬
                await this.addMessageWithTypewriter("æˆ‘å·²ç»æ·±åº¦åˆ†æäº†è¿™ç¯‡è®ºæ–‡ï¼Œæ‚¨å¯ä»¥å‘æˆ‘æé—®ä»»ä½•ç›¸å…³é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å»ºè®®çš„é—®é¢˜ï¼Œç‚¹å‡»å³å¯å¿«é€Ÿæé—®ï¼š", 'ai')
                
                await this.delay(800) // ç­‰æ–‡æœ¬æ˜¾ç¤ºå®Œåå†æ˜¾ç¤ºæŒ‰é’®

                const chatMessages = document.getElementById('chat-messages')
                const suggestionsDiv = document.createElement('div')
                suggestionsDiv.className = 'message-bubble message-ai'
                suggestionsDiv.innerHTML = `
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center mr-3 mt-1">
                            <span class="text-white text-sm">ğŸ’¡</span>
                        </div>
                        <div>
                            <p class="text-slate-300 mb-3 font-semibold">ğŸ” å¿«é€Ÿæé—®</p>
                            <div class="grid gap-2">
                                ${suggestedQuestions.map((q, index) => `
                                    <button onclick="app.askQuestion('${q}')" 
                                            class="text-left p-3 bg-gradient-to-r from-slate-700/20 to-slate-600/20 hover:from-slate-600/40 hover:to-slate-500/40 rounded-lg border border-slate-600/30 hover:border-cyan-500/50 text-slate-300 hover:text-white transition-all text-sm transform hover:scale-[1.02] hover:shadow-lg"
                                            style="animation: slideInUp 0.3s ease-out ${index * 0.1}s both;">
                                        <div class="flex items-center">
                                            <span class="text-cyan-400 mr-2">Q${index + 1}:</span>
                                            <span>${q}</span>
                                        </div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `

                chatMessages.appendChild(suggestionsDiv)
                chatMessages.scrollTop = chatMessages.scrollHeight
            }

            askQuestion(question) {
                document.getElementById('chat-input').value = question
                this.sendMessage()
            }

            async sendMessage() {
                const input = document.getElementById('chat-input')
                const message = input.value.trim()
                
                if (!message) return

                // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
                this.addMessage(message, 'user')
                input.value = ''

                // æ˜¾ç¤ºè¾“å…¥æŒ‡ç¤ºå™¨
                const typingIndicator = this.showTypingIndicator()

                // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
                await this.delay(1500)

                // ç§»é™¤è¾“å…¥æŒ‡ç¤ºå™¨
                typingIndicator.remove()

                // ç”ŸæˆAIå›å¤
                const aiResponse = this.generateAIResponse(message)
                this.addMessageWithTypewriter(aiResponse, 'ai')
            }

            addMessage(content, sender, isTemporary = false) {
                const chatMessages = document.getElementById('chat-messages')
                const messageDiv = document.createElement('div')
                messageDiv.className = `message-bubble mb-4 ${sender === 'user' ? 'message-user flex justify-end' : 'message-ai flex justify-start'}`

                if (sender === 'user') {
                    messageDiv.innerHTML = `
                        <div class="flex items-end max-w-md">
                            <div class="bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-4 py-2 rounded-2xl rounded-br-md shadow-lg text-sm leading-relaxed">
                                ${content}
                            </div>
                            <div class="w-8 h-8 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center ml-2 flex-shrink-0">
                                <span class="text-white text-xs">ğŸ‘¤</span>
                            </div>
                        </div>
                    `
                } else {
                    messageDiv.innerHTML = `
                        <div class="flex items-start max-w-3xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-2 mt-1 flex-shrink-0">
                                <span class="text-white text-xs">ğŸ¤–</span>
                            </div>
                            <div class="bg-slate-800/60 border border-slate-700/50 text-slate-200 px-4 py-2 rounded-2xl rounded-tl-md shadow-lg text-sm leading-relaxed">
                                ${this.formatMessageContent(content)}
                            </div>
                        </div>
                    `
                }

                chatMessages.appendChild(messageDiv)
                chatMessages.scrollTop = chatMessages.scrollHeight

                return messageDiv
            }

            // æ ¼å¼åŒ–æ¶ˆæ¯å†…å®¹
            formatMessageContent(content) {
                return content
                    .replace(/\*\*(.*?)\*\*/g, '<strong class="text-cyan-300 font-semibold">$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em class="text-slate-300 italic">$1</em>')
                    .replace(/\n\n/g, '</p><p class="mt-3">')
                    .replace(/\n/g, '<br>')
                    .replace(/^/, '<p>')
                    .replace(/$/, '</p>')
            }

            generateAIResponse(question) {
                // ç®€å•çš„é—®é¢˜åŒ¹é…å’Œå›å¤ç”Ÿæˆ
                const responses = {
                    'åˆ›æ–°': 'è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦åˆ›æ–°ç‚¹åŒ…æ‹¬ï¼š\n\n1. **å¤šæ¨¡æ€èåˆæŠ€æœ¯**ï¼šé¦–æ¬¡å°†æ–‡æœ¬ã€å›¾è¡¨å’Œå…¬å¼è¿›è¡Œç»Ÿä¸€å»ºæ¨¡\n2. **ä¸‰ç»´åˆ†ææ¡†æ¶**ï¼šä»å†…å®¹ã€æ–¹æ³•ã€ä»·å€¼ä¸‰ä¸ªç»´åº¦è¿›è¡Œç»¼åˆè¯„ä¼°\n3. **å¤§è§„æ¨¡é¢„è®­ç»ƒ**ï¼šåŸºäº100ä¸‡ç¯‡è®ºæ–‡çš„æ·±åº¦å­¦ä¹ æ¨¡å‹\n\nè¿™äº›åˆ›æ–°ç‚¹ä½¿å¾—è®ºæ–‡åˆ†æçš„å‡†ç¡®ç‡è¾¾åˆ°89.3%ï¼Œæ˜¾è‘—è¶…è¶Šäº†ä¼ ç»Ÿæ–¹æ³•ã€‚',
                    
                    'æ–¹æ³•': 'ç ”ç©¶æ–¹æ³•çš„åˆ†æå¦‚ä¸‹ï¼š\n\n**ä¼˜åŠ¿ï¼š**\n- âœ… é‡‡ç”¨äº†æœ€å…ˆè¿›çš„Transformeræ¶æ„\n- âœ… å¤§è§„æ¨¡æ•°æ®è®­ç»ƒä¿è¯äº†æ¨¡å‹æ³›åŒ–èƒ½åŠ›\n- âœ… å¤šæ¨¡æ€å¤„ç†èƒ½åŠ›å¼º\n\n**å±€é™æ€§ï¼š**\n- âš ï¸ è®¡ç®—èµ„æºéœ€æ±‚è¾ƒé«˜\n- âš ï¸ å¯¹ç‰¹å®šé¢†åŸŸè®ºæ–‡çš„é€‚åº”æ€§æœ‰å¾…æå‡\n- âš ï¸ ç¼ºä¹å¯¹è®ºæ–‡è´¨é‡çš„ä¸»è§‚è¯„ä»·ç»´åº¦',
                    
                    'ç»“æœ': 'å®éªŒç»“æœå¼ºæœ‰åŠ›åœ°æ”¯æŒäº†ä½œè€…çš„ç»“è®ºï¼š\n\n- **å‡†ç¡®ç‡æŒ‡æ ‡**ï¼šåœ¨å¤šä¸ªbenchmarkä¸Šè¾¾åˆ°SOTAæ°´å¹³\n- **æ•ˆç‡æå‡**ï¼šç›¸æ¯”äººå·¥åˆ†ææå‡80%çš„å¤„ç†é€Ÿåº¦\n- **ç”¨æˆ·è¯„ä»·**ï¼š85%çš„ä¸“å®¶è®¤ä¸ºåˆ†æç»“æœæœ‰ä»·å€¼\n\næ•°æ®å……åˆ†ï¼Œå®éªŒè®¾è®¡åˆç†ï¼Œç»“è®ºå¯ä¿¡åº¦é«˜ã€‚',
                    
                    'å½±å“': 'è¿™é¡¹ç ”ç©¶å¯¹å­¦æœ¯ç•Œçš„å½±å“æ˜¯æ·±è¿œçš„ï¼š\n\nğŸ”¬ **å­¦æœ¯ä»·å€¼**ï¼šæ¨åŠ¨äº†AIåœ¨å­¦æœ¯åˆ†æé¢†åŸŸçš„åº”ç”¨\nğŸ­ **äº§ä¸šå½±å“**ï¼šä¸ºå­¦æœ¯æœåŠ¡å¹³å°æä¾›äº†æŠ€æœ¯å‚è€ƒ\nğŸ“š **æ•™è‚²æ„ä¹‰**ï¼šå¸®åŠ©ç ”ç©¶è€…æ›´å¥½åœ°ç†è§£è®ºæ–‡è´¨é‡è¯„ä¼°\n\né¢„è®¡å°†åœ¨æœªæ¥3-5å¹´å†…å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚',
                    
                    'æœªæ¥': 'è®ºæ–‡æåˆ°çš„æœªæ¥å·¥ä½œæ–¹å‘åŒ…æ‹¬ï¼š\n\n1. **è·¨è¯­è¨€æ”¯æŒ**ï¼šæ‰©å±•åˆ°æ›´å¤šè¯­è¨€çš„è®ºæ–‡åˆ†æ\n2. **å®æ—¶åˆ†æ**ï¼šå¼€å‘æµå¼å¤„ç†èƒ½åŠ›\n3. **ä¸ªæ€§åŒ–è¯„ä¼°**ï¼šæ ¹æ®ç”¨æˆ·ä¸“ä¸šèƒŒæ™¯è°ƒæ•´åˆ†æç»´åº¦\n4. **åä½œåˆ†æ**ï¼šæ”¯æŒå¤šäººååŒè¯„ä¼°\n\nè¿™äº›æ–¹å‘éƒ½å…·æœ‰å¾ˆå¥½çš„ç ”ç©¶ä»·å€¼å’Œåº”ç”¨å‰æ™¯ã€‚'
                }

                // ç®€å•åŒ¹é…
                for (const [key, response] of Object.entries(responses)) {
                    if (question.includes(key)) {
                        return response
                    }
                }

                // é»˜è®¤å›å¤
                return `å…³äºæ‚¨çš„é—®é¢˜"${question}"ï¼ŒåŸºäºæˆ‘å¯¹è¿™ç¯‡è®ºæ–‡çš„åˆ†æï¼š\n\nè¿™æ˜¯ä¸€ç¯‡é«˜è´¨é‡çš„å­¦æœ¯è®ºæ–‡ï¼Œä¸»è¦ç ”ç©¶äº†åŸºäºæ·±åº¦å­¦ä¹ çš„è®ºæ–‡æ™ºèƒ½åˆ†ææ–¹æ³•ã€‚è®ºæ–‡åœ¨æŠ€æœ¯åˆ›æ–°ã€å®éªŒè®¾è®¡å’Œåº”ç”¨ä»·å€¼æ–¹é¢éƒ½è¡¨ç°å‡ºè‰²ã€‚\n\nå¦‚æœæ‚¨éœ€è¦äº†è§£æ›´å…·ä½“çš„å†…å®¹ï¼Œè¯·å°è¯•é—®ä¸€äº›æ›´å…·ä½“çš„é—®é¢˜ï¼Œæ¯”å¦‚å…³äºç ”ç©¶æ–¹æ³•ã€å®éªŒç»“æœæˆ–è€…åº”ç”¨å‰æ™¯ç­‰æ–¹é¢ã€‚`
            }

            showNotification(message, type = 'info', duration = 3000) {
                // ç¡®ä¿é€šçŸ¥å®¹å™¨å­˜åœ¨
                this.ensureNotificationContainer()
                
                const notification = document.createElement('div')
                notification.className = `notification-item p-4 rounded-lg border backdrop-blur-sm transform translate-x-full transition-all duration-300 mb-3 shadow-lg`
                
                const colors = {
                    success: 'bg-green-500/20 border-green-500/50 text-green-400',
                    error: 'bg-red-500/20 border-red-500/50 text-red-400',
                    info: 'bg-blue-500/20 border-blue-500/50 text-blue-400'
                }
                
                const icons = {
                    success: 'âœ…',
                    error: 'âŒ', 
                    info: 'â„¹ï¸'
                }
                
                notification.className += ` ${colors[type]}`
                notification.innerHTML = `
                    <div class="flex items-center">
                        <span class="mr-2">${icons[type]}</span>
                        <span class="flex-1">${message}</span>
                        <button onclick="this.parentElement.parentElement.remove(); app.updateNotificationPositions()" class="ml-2 text-slate-400 hover:text-white">
                            <i class="fas fa-times text-xs"></i>
                        </button>
                    </div>
                `

                const container = document.getElementById('notification-container')
                container.appendChild(notification)

                // æ›´æ–°æ‰€æœ‰é€šçŸ¥ä½ç½®
                this.updateNotificationPositions()

                // æ˜¾ç¤ºåŠ¨ç”»
                setTimeout(() => {
                    notification.classList.remove('translate-x-full')
                }, 100)

                // è‡ªåŠ¨æ¶ˆå¤±
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        notification.style.transition = 'all 0.3s ease-out'
                        notification.style.opacity = '0'
                        notification.style.transform = 'translateX(100%) scale(0.9)'
                        
                        setTimeout(() => {
                            if (document.body.contains(notification)) {
                                notification.remove()
                                this.updateNotificationPositions()
                            }
                        }, 300)
                    }
                }, duration)
            }

            // ç¡®ä¿é€šçŸ¥å®¹å™¨å­˜åœ¨
            ensureNotificationContainer() {
                if (!document.getElementById('notification-container')) {
                    const container = document.createElement('div')
                    container.id = 'notification-container'
                    container.className = 'fixed top-4 right-4 z-50 max-w-sm'
                    
                    // æ·»åŠ æ¸…é™¤æ‰€æœ‰é€šçŸ¥çš„æŒ‰é’®
                    const clearButton = document.createElement('div')
                    clearButton.id = 'clear-all-notifications'
                    clearButton.className = 'hidden text-center mb-2'
                    clearButton.innerHTML = `
                        <button onclick="app.clearAllNotifications()" class="px-3 py-1 bg-slate-700/50 border border-slate-600/50 rounded text-slate-300 hover:bg-slate-600/50 transition-all text-xs">
                            <i class="fas fa-times mr-1"></i>æ¸…é™¤æ‰€æœ‰
                        </button>
                    `
                    container.appendChild(clearButton)
                    
                    document.body.appendChild(container)
                }
            }

            // æ¸…é™¤æ‰€æœ‰é€šçŸ¥
            clearAllNotifications() {
                const container = document.getElementById('notification-container')
                if (!container) return
                
                const notifications = container.querySelectorAll('.notification-item')
                notifications.forEach((notification, index) => {
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            notification.style.transition = 'all 0.2s ease-out'
                            notification.style.opacity = '0'
                            notification.style.transform = 'translateX(100%) scale(0.8)'
                            
                            setTimeout(() => {
                                if (document.body.contains(notification)) {
                                    notification.remove()
                                }
                            }, 200)
                        }
                    }, index * 50) // ä¾æ¬¡æ¶ˆå¤±
                })
                
                // éšè—æ¸…é™¤æŒ‰é’®
                setTimeout(() => {
                    const clearButton = document.getElementById('clear-all-notifications')
                    if (clearButton) {
                        clearButton.classList.add('hidden')
                    }
                }, notifications.length * 50 + 200)
            }

            // æ›´æ–°é€šçŸ¥ä½ç½®
            updateNotificationPositions() {
                const container = document.getElementById('notification-container')
                if (!container) return
                
                const notifications = container.querySelectorAll('.notification-item')
                const clearButton = document.getElementById('clear-all-notifications')
                
                // æ˜¾ç¤ºæˆ–éšè—æ¸…é™¤æ‰€æœ‰æŒ‰é’®
                if (clearButton) {
                    if (notifications.length >= 2) {
                        clearButton.classList.remove('hidden')
                    } else {
                        clearButton.classList.add('hidden')
                    }
                }
                
                notifications.forEach((notification, index) => {
                    // æ·»åŠ è¿›å…¥åŠ¨ç”»çš„å»¶è¿Ÿï¼Œè®©é€šçŸ¥ä¾æ¬¡å‡ºç°
                    notification.style.animationDelay = `${index * 0.1}s`
                    
                    // å¦‚æœæœ‰è¶…è¿‡5ä¸ªé€šçŸ¥ï¼Œç§»é™¤æœ€æ—§çš„
                    if (notifications.length > 5 && index === 0) {
                        notification.style.opacity = '0'
                        notification.style.transform = 'translateX(100%) scale(0.8)'
                        setTimeout(() => {
                            if (document.body.contains(notification)) {
                                notification.remove()
                                this.updateNotificationPositions()
                            }
                        }, 200)
                    }
                })
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes'
                const k = 1024
                const sizes = ['Bytes', 'KB', 'MB', 'GB']
                const i = Math.floor(Math.log(bytes) / Math.log(k))
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]
            }

            // æ˜¾ç¤ºæ§åˆ¶æŒ‰é’®
            showControlButtons() {
                document.getElementById('restart-analysis').classList.remove('hidden')
                document.getElementById('new-document').classList.remove('hidden')
            }

            // é‡æ–°åˆ†æå½“å‰æ–‡æ¡£
            restartAnalysis() {
                if (confirm('ç¡®å®šè¦é‡æ–°åˆ†æå½“å‰æ–‡æ¡£å—ï¼Ÿè¿™å°†æ¸…é™¤å½“å‰çš„åˆ†æç»“æœå¹¶é‡æ–°å¼€å§‹æ•´ä¸ªæµç¨‹ã€‚')) {
                    this.resetToAnalysis()
                    this.showNotification('ğŸ”„ é‡æ–°å¼€å§‹åˆ†æå½“å‰æ–‡æ¡£...', 'info')
                    
                    // é‡æ–°å¼€å§‹åˆ†ææµç¨‹
                    setTimeout(() => {
                        this.simulateChunking()
                    }, 1000)
                }
            }

            // ä¸Šä¼ æ–°æ–‡æ¡£
            uploadNewDocument() {
                if (confirm('ç¡®å®šè¦ä¸Šä¼ æ–°æ–‡æ¡£å—ï¼Ÿè¿™å°†æ¸…é™¤å½“å‰çš„æ‰€æœ‰æ•°æ®å¹¶è¿”å›ä¸Šä¼ ç•Œé¢ã€‚')) {
                    this.resetToUpload()
                    this.showNotification('ğŸ“„ ç³»ç»Ÿå·²é‡ç½®ï¼Œè¯·ä¸Šä¼ æ–°æ–‡æ¡£', 'success')
                }
            }

            // é‡ç½®åˆ°åˆ†æé˜¶æ®µï¼ˆä¿ç•™å·²ä¸Šä¼ çš„æ–‡æ¡£ï¼‰
            resetToAnalysis() {
                // éšè—åˆ†æåçš„åŒºåŸŸ
                document.getElementById('analysis-section').classList.add('hidden')
                document.getElementById('neural-network-section').classList.add('hidden')
                document.getElementById('chat-section').classList.add('hidden')
                
                // æ˜¾ç¤ºæ–‡æ¡£åˆ†å‰²åŒºåŸŸ
                document.getElementById('chunking-section').classList.remove('hidden')
                
                // éšè—æ§åˆ¶æŒ‰é’®
                document.getElementById('restart-analysis').classList.add('hidden')
                document.getElementById('new-document').classList.add('hidden')
                
                // é‡ç½®åˆ†å‰²åŒºåŸŸå†…å®¹
                const chunkContainer = document.getElementById('chunk-container')
                chunkContainer.innerHTML = ''
                
                // é‡ç½®ç»Ÿè®¡ä¿¡æ¯
                document.getElementById('chunk-count').textContent = '0'
                document.getElementById('avg-chunk-size').textContent = '0'
                document.getElementById('total-tokens').textContent = '0'
                
                // é‡ç½®æ–‡æ¡£ç»“æ„çŠ¶æ€
                document.querySelectorAll('.doc-section').forEach(section => {
                    section.classList.remove('processing', 'completed')
                })
                
                // æ¸…ç©ºèŠå¤©è®°å½•
                const chatMessages = document.getElementById('chat-messages')
                if (chatMessages) {
                    chatMessages.innerHTML = ''
                }
                
                // é‡ç½®çŠ¶æ€å˜é‡
                this.currentStage = 'chunking'
                this.analysisComplete = false
                this.nodeAnimationProgress = 0
                
                // æ¸…é™¤æ­£åœ¨è¿è¡Œçš„åŠ¨ç”»
                if (this.chunkingInterval) {
                    clearInterval(this.chunkingInterval)
                }
            }

            // é‡ç½®åˆ°ä¸Šä¼ é˜¶æ®µ
            resetToUpload() {
                // éšè—æ‰€æœ‰åˆ†æåŒºåŸŸ
                document.getElementById('chunking-section').classList.add('hidden')
                document.getElementById('analysis-section').classList.add('hidden')
                document.getElementById('neural-network-section').classList.add('hidden')
                document.getElementById('chat-section').classList.add('hidden')
                
                // æ˜¾ç¤ºä¸Šä¼ åŒºåŸŸ
                document.getElementById('upload-section').classList.remove('hidden')
                
                // éšè—æ§åˆ¶æŒ‰é’®
                document.getElementById('restart-analysis').classList.add('hidden')
                document.getElementById('new-document').classList.add('hidden')
                
                // é‡ç½®ä¸Šä¼ åŒºåŸŸçŠ¶æ€
                const uploadArea = document.getElementById('upload-area')
                uploadArea.className = 'border-2 border-dashed border-slate-600 rounded-lg p-8 text-center transition-all hover:border-cyan-500 hover:bg-cyan-500/5'
                uploadArea.innerHTML = `
                    <div class="mb-4">
                        <i class="fas fa-cloud-upload-alt text-4xl text-slate-400 mb-4 block"></i>
                        <p class="text-lg text-slate-300 mb-2">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»ä¸Šä¼ </p>
                        <p class="text-sm text-slate-500">æ”¯æŒ PDFã€DOCã€DOCX æ ¼å¼</p>
                    </div>
                    <button class="cyber-button">
                        <i class="fas fa-folder-open mr-2"></i>é€‰æ‹©æ–‡ä»¶
                    </button>
                `
                
                // æ¸…ç©ºèŠå¤©è®°å½•
                const chatMessages = document.getElementById('chat-messages')
                if (chatMessages) {
                    chatMessages.innerHTML = ''
                }
                
                // é‡ç½®æ‰€æœ‰çŠ¶æ€å˜é‡
                this.uploadedFile = null
                this.currentStage = 'upload'
                this.analysisComplete = false
                this.nodeAnimationProgress = 0
                
                // æ¸…é™¤ä»»ä½•æ­£åœ¨è¿è¡Œçš„åŠ¨ç”»
                if (this.chunkingInterval) {
                    clearInterval(this.chunkingInterval)
                }
                
                // é‡æ–°ç»‘å®šä¸Šä¼ äº‹ä»¶
                this.setupFileUpload()
            }

            // å¯¼å‡ºå½“å‰ä¼šè¯
            exportCurrentSession() {
                const sessionData = {
                    timestamp: new Date().toISOString(),
                    fileName: this.uploadedFile ? this.uploadedFile.name : 'unknown',
                    chatHistory: this.getChatHistory(),
                    networkData: this.networkData,
                    analysisStage: this.currentStage
                }

                const dataStr = JSON.stringify(sessionData, null, 2)
                const dataBlob = new Blob([dataStr], {type: 'application/json'})
                
                const url = URL.createObjectURL(dataBlob)
                const link = document.createElement('a')
                link.href = url
                link.download = `æ–‡çŒ®æ¦¨æ±æœº_ä¼šè¯è®°å½•_${new Date().getTime()}.json`
                document.body.appendChild(link)
                link.click()
                document.body.removeChild(link)
                URL.revokeObjectURL(url)
                
                this.showNotification('ğŸ“„ ä¼šè¯è®°å½•å·²å¯¼å‡º', 'success')
            }

            // è·å–èŠå¤©å†å²
            getChatHistory() {
                const chatMessages = document.getElementById('chat-messages')
                const messages = []
                
                if (chatMessages) {
                    const messageElements = chatMessages.querySelectorAll('.message-bubble')
                    messageElements.forEach(msg => {
                        const isAI = msg.classList.contains('message-ai')
                        const textContent = msg.textContent.trim()
                        if (textContent) {
                            messages.push({
                                type: isAI ? 'ai' : 'user',
                                content: textContent,
                                timestamp: new Date().toISOString()
                            })
                        }
                    })
                }
                
                return messages
            }

            // æ˜¾ç¤ºè¾“å…¥æŒ‡ç¤ºå™¨
            showTypingIndicator() {
                const chatMessages = document.getElementById('chat-messages')
                const indicatorDiv = document.createElement('div')
                indicatorDiv.className = 'message-bubble message-ai'
                indicatorDiv.innerHTML = `
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center mr-3 mt-1">
                            <span class="text-white text-sm">ğŸ¤–</span>
                        </div>
                        <div class="typing-indicator">
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                    </div>
                `
                
                chatMessages.appendChild(indicatorDiv)
                chatMessages.scrollTop = chatMessages.scrollHeight
                
                return indicatorDiv
            }

            // æ·»åŠ å¸¦æ‰“å­—æœºæ•ˆæœçš„æ¶ˆæ¯
            async addMessageWithTypewriter(content, sender) {
                const chatMessages = document.getElementById('chat-messages')
                const messageDiv = document.createElement('div')
                messageDiv.className = `message-bubble mb-4 ${sender === 'user' ? 'message-user flex justify-end' : 'message-ai flex justify-start'}`

                if (sender === 'ai') {
                    messageDiv.innerHTML = `
                        <div class="flex items-start max-w-3xl">
                            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-2 mt-1 flex-shrink-0">
                                <span class="text-white text-xs">ğŸ¤–</span>
                            </div>
                            <div class="bg-slate-800/60 border border-slate-700/50 text-slate-200 px-4 py-2 rounded-2xl rounded-tl-md shadow-lg typewriter text-sm leading-relaxed">
                                <span class="typewriter-text"></span>
                                <span class="typewriter-cursor"></span>
                            </div>
                        </div>
                    `
                } else {
                    messageDiv.innerHTML = `
                        <div class="flex items-end max-w-md">
                            <div class="bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-4 py-2 rounded-2xl rounded-br-md shadow-lg typewriter text-sm leading-relaxed">
                                <span class="typewriter-text"></span>
                                <span class="typewriter-cursor"></span>
                            </div>
                            <div class="w-8 h-8 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center ml-2 flex-shrink-0">
                                <span class="text-white text-xs">ğŸ‘¤</span>
                            </div>
                        </div>
                    `
                }

                chatMessages.appendChild(messageDiv)
                chatMessages.scrollTop = chatMessages.scrollHeight

                // å¼€å§‹æ‰“å­—æœºåŠ¨ç”»
                const textElement = messageDiv.querySelector('.typewriter-text')
                await this.typewriterAnimation(textElement, content)
                
                // ç§»é™¤å…‰æ ‡å¹¶æ ¼å¼åŒ–æœ€ç»ˆå†…å®¹
                const cursor = messageDiv.querySelector('.typewriter-cursor')
                if (cursor) {
                    cursor.remove()
                }
                
                // æœ€ç»ˆæ ¼å¼åŒ–å†…å®¹
                if (sender === 'ai') {
                    textElement.innerHTML = this.formatMessageContent(content)
                } else {
                    textElement.textContent = content
                }

                return messageDiv
            }

            // æ‰“å­—æœºåŠ¨ç”» - åªå¤„ç†çº¯æ–‡æœ¬
            async typewriterAnimation(element, text, speed = 25) {
                element.textContent = ''
                
                // æ¸…ç†æ–‡æœ¬ï¼Œç§»é™¤markdownæ ‡è®°ç”¨äºæ‰“å­—æ•ˆæœ
                const cleanText = text
                    .replace(/\*\*(.*?)\*\*/g, '$1')  // ç§»é™¤ç²—ä½“æ ‡è®°
                    .replace(/\*(.*?)\*/g, '$1')     // ç§»é™¤æ–œä½“æ ‡è®°
                    .replace(/\n+/g, ' ')            // å°†æ¢è¡Œç¬¦æ›¿æ¢ä¸ºç©ºæ ¼
                
                for (let i = 0; i < cleanText.length; i++) {
                    element.textContent += cleanText[i]
                    
                    // æ»šåŠ¨åˆ°åº•éƒ¨
                    const chatMessages = document.getElementById('chat-messages')
                    chatMessages.scrollTop = chatMessages.scrollHeight
                    
                    // æ ¹æ®å­—ç¬¦ç±»å‹è°ƒæ•´é€Ÿåº¦
                    let delay = speed
                    if (cleanText[i] === 'ã€‚' || cleanText[i] === 'ï¼' || cleanText[i] === 'ï¼Ÿ') {
                        delay = speed * 4 // å¥å·ç­‰åœé¡¿æ›´é•¿
                    } else if (cleanText[i] === 'ï¼Œ' || cleanText[i] === 'ï¼›' || cleanText[i] === 'ï¼š') {
                        delay = speed * 2.5 // é€—å·ç­‰ä¸­ç­‰åœé¡¿
                    } else if (cleanText[i] === ' ') {
                        delay = speed * 0.3 // ç©ºæ ¼å¿«ä¸€äº›
                    } else if (/[a-zA-Z]/.test(cleanText[i])) {
                        delay = speed * 0.6 // è‹±æ–‡å­—æ¯å¿«ä¸€äº›
                    }
                    
                    await this.delay(delay)
                }
            }

            // è®¾ç½®é”®ç›˜å¿«æ·é”®
            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    // Ctrl+R: é‡æ–°åˆ†æ
                    if (e.ctrlKey && e.key === 'r') {
                        e.preventDefault()
                        if (document.getElementById('restart-analysis').offsetParent !== null) {
                            this.restartAnalysis()
                        }
                    }
                    
                    // Ctrl+N: æ–°æ–‡æ¡£
                    if (e.ctrlKey && e.key === 'n') {
                        e.preventDefault()
                        if (document.getElementById('new-document').offsetParent !== null) {
                            this.uploadNewDocument()
                        }
                    }
                    
                    // Escape: å…³é—­æ¨¡æ€æ¡†
                    if (e.key === 'Escape') {
                        const modal = document.getElementById('search-modal')
                        if (modal && !modal.classList.contains('hidden')) {
                            modal.classList.add('hidden')
                        }
                    }
                })
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms))
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        window.app = new LiteratureJuicerApp()

        // æ·»åŠ ä¸€äº›èƒŒæ™¯åŠ¨æ•ˆ
        document.addEventListener('DOMContentLoaded', () => {
            // é¼ æ ‡ç§»åŠ¨æ•ˆæœ
            document.addEventListener('mousemove', (e) => {
                const x = e.clientX / window.innerWidth
                const y = e.clientY / window.innerHeight
                
                document.documentElement.style.setProperty('--mouse-x', x)
                document.documentElement.style.setProperty('--mouse-y', y)
            })
        })
    </script>
</body>
</html>
